<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="anime.min.js"></script>
   </head>
   <style>
      .path-anime{
         
      }
      body{
         margin: 0;
         width: 100vw;
         height: 100vh;
      }
      #box{
         position: absolute;
         bottom: 0;
         left: 0;
         right: 0;
         margin-left: auto;
         fill:indigo;
      }
      #box  g {
            width: 100%;
            height: 100%;
            color: indigo;
         }
         #box  g *{
            width: 100%;
            height: 100%;
            stroke: indigo;
            
         }
      .scence-container{
         width: 100%;
         height: 100%;
         position: relative;
         display: flex;
      }
      .flex-container {
         width: 100%;
         height: 100vh;
      }
      .flex-container svg{
         margin: auto;
      }
      .flying-obj{
         position: absolute;
         width: 40px;
         height: 40px;
         align-self: flex-start;
      }
      .fading{
         transition: all 0.2s;
         opacity: 0;

      }
      .path-svg{
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
      }
      .path-svg path{
         width: 100%!important;         
      }
   </style>
<body>
   <div class="flex-container">
   <div class="scence-container">
   <svg>
      <g id="ball">
            <circle
         style="opacity:1;fill:#460082;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.5291667;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="path4991"
         cx="305.51553"
         cy="17.920185"
         r="13.229166" />
      <ellipse
         style="opacity:1;fill:#460082;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:0.5291667;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
         id="path4993"
         cx="305.51553"
         cy="7.6911798"
         rx="5.2024026"
         ry="2.247438" />
      <path
         style="fill:#460082;fill-opacity:1;stroke:#ffffff;stroke-width:0.5291667;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
         d="m 301.9661,9.6803206 c 0,0 -2.92376,3.0176674 -3.12421,9.6993974 1e-5,6.94902 4.39849,11.69837 4.39849,11.69837"
         id="path4995"
         inkscape:connector-curvature="0"
         sodipodi:nodetypes="ccc" />
      <path
         style="fill:#460082;fill-opacity:1;stroke:#ffffff;stroke-width:0.52916676;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
         d="m 308.3353,9.6803206 c 0,0 2.92376,3.0176674 3.12421,9.6993974 -1e-5,6.94902 -4.39849,11.69837 -4.39849,11.69837"
         id="path4995-7"
         inkscape:connector-curvature="0"
         sodipodi:nodetypes="ccc" />
      </g>
    <path
       style="fill:none;stroke:#000000;stroke-width:0.26458332px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
       d="M 291.85833,21.712378 C 44.901281,63.406424 19.777945,102.96231 19.777945,102.96231 c 0,0 -27.2614916,18.17433 39.555888,43.8322 66.817387,25.65788 246.422497,-4.81085 251.767907,-14.96709 5.34537,-10.15624 -89.80257,-45.435817 -134.16932,-38.486811 -44.36674,6.949011 -145.929154,23.519721 -142.187382,42.763121 3.741774,19.24341 36.883194,45.43582 81.249932,61.472 44.36675,16.03617 117.06406,11.22531 125.61668,8.01808 8.55262,-3.20723 68.42101,-24.5888 55.05752,-29.39965 -13.36347,-4.81085 -215.953773,0 -213.815617,24.05426 2.138156,24.05426 72.697307,71.09369 72.697307,71.09369 l -1.06908,3.20723"
       id="ball-path"
       class="item-path"
       inkscape:connector-curvature="0" />
   </svg>
   <svg id="box" width="160.93758" height="125.50215" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">

      <metadata id="metadata5224">image/svg+xml</metadata>
     
      <g class="layer">
       <title>Layer 1</title>
      
       <g id="layer1" transform="translate(-18.466661,-171.67717)">
        <path d="m99.02972,185.14932c17.79928,8.86847 35.59855,17.73693 53.39782,26.6054c-17.79927,8.86846 -35.59855,17.73693 -53.39782,26.6054c-17.79928,-8.86847 -35.59855,-17.73693 -53.39782,-26.6054c17.79927,-8.86846 35.59855,-17.73693 53.39782,-26.6054z" fill="#ffffff" fill-rule="evenodd" id="rect5538" stroke="#000000" stroke-dashoffset="0" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m152.72032,270.24236c-17.8752,8.89079 -35.7504,17.78159 -53.6256,26.67238c-0.02167,-19.51821 -0.04333,-39.03641 -0.065,-58.55462c17.79927,-8.86846 35.59853,-17.73693 53.3978,-26.60539c0.0976,19.49588 0.1952,38.99175 0.2928,58.48763z" fill="#ffffff" fill-rule="evenodd" id="rect5538-0" stroke="#000000" stroke-dashoffset="0" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m45.33871,270.24235c17.8752,8.89079 35.7504,17.78159 53.6256,26.67238c0.02167,-19.51821 0.04333,-39.03641 0.065,-58.55462c-17.79927,-8.86846 -35.59853,-17.73693 -53.3978,-26.60539c-0.0976,19.49588 -0.1952,38.99175 -0.2928,58.48763z" fill="#ffffff" fill-rule="evenodd" id="rect5538-0-2" stroke="#000000" stroke-dashoffset="0" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m99.02971,185.14932c0,17.73693 0,35.47386 0,53.21079" fill="none" id="path5765" stroke="#000000" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m72.14531,171.86423l26.69586,13.28552l-53.30361,26.5272l-26.69586,-13.28552l53.30361,-26.5272z" fill="#ffffff" fill-rule="evenodd" id="rect5565-2-3" class="lidn" stroke="#000000" stroke-dashoffset="0" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m152.33287,211.67687l26.69585,13.28552l-53.30361,26.5272l-26.69585,-13.28552l53.30361,-26.5272z" fill="#ffffff" fill-rule="evenodd" id="rect5565-2" class="lids" stroke="#000000" stroke-dashoffset="0" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m45.63193,211.75474l-26.69585,13.28552l53.30361,26.5272l26.69585,-13.28552l-53.30361,-26.5272z" fill="#ffffff" fill-rule="evenodd" id="rect5565-2-6" class="lidw" stroke="#000000" stroke-dashoffset="0" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m125.72559,171.86381l-26.69586,13.28552l53.30361,26.5272l26.69586,-13.28552l-53.30361,-26.5272z" fill="#ffffff" fill-rule="evenodd" id="rect5565-2-4" class="lide" stroke="#000000" stroke-dashoffset="0" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" stroke-width="0.52917"/>
      
        <path d="m152.3244,250.8869c-6.42559,2.96081 -12.85119,5.92163 -19.27678,8.88244" fill="none" id="path6612" stroke="#000000" stroke-linecap="round" stroke-miterlimit="4" stroke-width="0.52917"/>
        <path d="m152.3244,250.8869c-6.42559,2.96081 -12.85119,5.92163 -19.27678,8.88244" fill="none" id="path6612-7" stroke="#000000" stroke-linecap="round" stroke-miterlimit="4" stroke-width="0.52917" transform="translate(2.0533333e-6,9.5439038)"/>
        <path d="m152.3244,250.8869c-6.42559,2.96081 -12.85119,5.92163 -19.27678,8.88244" fill="none" id="path6612-5" stroke="#000000" stroke-linecap="round" stroke-miterlimit="4" stroke-width="0.52917" transform="translate(0.03779967,4.7436062)"/>
       </g>
      </g>
     </svg>
     <img class="flying-obj" id="ball" src="./ball.svg"/>
     <img class="flying-obj" id="camera" src="./camera.svg"/>
</div>
</div>
<script >
   const path2String = "m 45.725651,211.67687 28.677664,-14.87371 53.303615,26.5272 -28.677667,14.87371";
   const path1String = "45.631926,211.75474 -26.695848,13.28552 53.303612,26.5272 26.695848,-13.28552";
   const path2 = path2String.replace(",", " ");
   const path3String = "m 45.631926,211.75474 0.102664,-14.87371 53.30361,26.5272 -0.102662,14.87371";
   const path1 = path1String.replace(",", " ");
   const path = anime.path("#path34");
   var animes = [];
   var objects = ["ball","camera"];
   const lidN = {
      path2:"m 98.792632,171.86423 0.04854,13.28552 -53.303611,26.5272 -0.04854,-13.28552 z",
      path3:"m 123.36108,197.37762 -24.519912,-12.22787 -53.303611,26.5272 24.519916,12.22787 z"
   }
   const lidS = {
      path2: "m 152.33287,211.67687 0.0485,-13.73978 -53.303611,26.5272 -0.04853,13.73978 z",
      path3: "m 152.33287,211.67687 -27.54373,-13.73978 -53.303613,26.5272 27.543736,13.73978 z"
   }
   const lidE = {
      path2: "m 99.078269,171.86381 -0.04854,13.28552 53.303611,26.5272 0.0485,-13.28552 z",
      path3: "m 72.419749,198.39294 26.60998,-13.24361 53.303611,26.5272 -26.61002,13.24361 z"
   }
   const lidW = {
      path2: "m 45.631926,211.75474 -0.04853,-16.5746 53.303612,26.5272 0.04853,16.5746 z",
      path3: "m 45.631926,211.75474 26.787779,-13.3618 53.303615,26.5272 -26.787782,13.3618 z"
   }
   const timeline1 = anime.timeline({
      duration: 500,
      autoplay: false
   })
   const timeline2 = anime.timeline({
      duration: 500,
      autoplay: false
   })
    timeline1.add({
       targets: '.lidn',
       d:[
         
         {value: lidN.path2},
         {value: lidN.path3}
       ],
       easing: "linear",
    }).add({
      targets: '.lide',
       d:[
         
         {value: lidE.path2},
         {value: lidE.path3}
       ],
       easing: "linear",
    })
    timeline2.add({
       targets: ".lids",
       d:[
         
         {value: lidS.path2},
         {value: lidS.path3}
       ],
       easing: "linear",
    }).add({
      targets: '.lidw',
       d:[
         
         {value: lidW.path2},
         {value: lidW.path3}
       ],
       easing: "linear",
    })
   let closeTheBox = () => {
            timeline1.play();
            timeline2.play();  
            timeline1.direction= "reverse";
            timeline2.direction= "reverse";
   }
   let openTheBox = ()=>{
      
      timeline1.play();
      timeline2.play();  
      timeline1.direction= "normal";
      timeline2.direction= "normal";
   }
   let allocateObjectToPathAnimation = (listOfObject) =>{
      for(let i = 0; i < listOfObject.length; i+=1){
         var objName = listOfObject[i];
         var obj = document.getElementById(objName);
         var pathSVG = document.getElementById(objName + "-path");
         let pathLeftOffset = parseInt(pathSVG.getBoundingClientRect().left);
         var dapath = pathSVG.querySelector("path");
         let pathAnimeObj = anime.path("#"+dapath.getAttribute("id"));
         var pathStartCord = dapath.getAttribute("d").split(" ")[1].split(","); //0 for x 1 for y
         var moveByLeft = pathLeftOffset + parseInt(pathStartCord[1]) - obj.offsetWidth;
         var moveByTop =  obj.offsetHeight *  0.5 * -1;
         obj.style.left = moveByLeft + "px";
         obj.style.top =  moveByTop + "px";
         let daAnime = anime({
         targets: "#"+objName,
         translateX: pathAnimeObj('x'),
         translateY: pathAnimeObj('y'),
         //rotate: pathAnimeObj("angle"),
         easing: "easeInOutCubic",
         duration: "3000",
         autoplay:false
         });
         if(i === listOfObject.length - 1){
            console.log(daAnime);
            daAnime.update = (anim) => {
               let fadeCheckPoint = 78.5
               if(obj.classList.contains("fading")){
                  obj.classList.remove("fading");      
               }
               if(anim.progress >= fadeCheckPoint ){
                  obj.classList.add("fading");
               }
               if(anim.reversed === true && anim.progress === 100){
                  openTheBox();
               }
            };
            daAnime.complete = (anim)=>{
               if(anim.reversed === false){
               closeTheBox(anim.reversed);
            }
            }
         }
         animes.push(daAnime);
      }
   }
   allocateObjectToPathAnimation(objects);
</script>
</body>

</html>